const acceptableParameters=["targets","duration","animation","delay","late","play","direction","endDelay","whenVisible","threshold","iteration"];function initialParameters(i){switch(i){case"targets":return"body";case"duration":return 1e3;case"animation":return"ease-out-elastic";case"delay":return 0;case"late":return 300;case"play":return!0;case"direction":return"normal";case"endDelay":return 0;case"whenVisible":return!0;case"threshold":return.1;case"iteration":return 1}}function animationFunctions(i){switch(i){case"ease-in-out":case"ease-in-out-elastic":return()=>easeInOutElastic;case"ease-in":case"ease-in-elastic":return()=>easeInElastic;case"ease-out-elastic":case"ease-out":return()=>easeOutElastic;case"ease-in-quad":return()=>easeInQuad;case"ease-out-quad":return()=>easeOutQuad;case"ease-in-out-quad":return()=>easeInOutQuad;case"ease-in-circular":return()=>easeInCirc;case"ease-out-circular":return()=>easeOutCirc;case"ease-in-out-circular":return()=>easeInOutCirc;case"ease-in-cubic":return()=>easeInCubic;case"ease-out-cubic":return()=>easeOutCubic;case"ease-in-out-cubic":return()=>easeInOutCubic;case"ease-in-sine":return()=>easeInSine;case"ease-out-sine":return()=>easeOutSine;case"ease-in-out-sine":return()=>easeInOutSine;case"ease-in-expo":return()=>easeInExpo;case"ease-out-sine":return()=>easeOutExpo;case"ease-in-out-sine":return()=>easeInOutExpo;case"ease-linear":return()=>easeLinear;default:return()=>easeOutElastic}}const degPostfix=["rotateX","rotateY","rotateZ","skewX","skewY"],pxPostfix=["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","borderRadius"],validAnimations=["translateX","translateY","translateZ","rotateX","rotateY","rotateZ","scaleX","scaleY","scaleZ","skewX","skewY","perspective","opacity","backgroundColor","borderRadius","d"],defaultTransforms={translateX:0,translateY:0,translateZ:0,rotateX:0,rotateY:0,rotateZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,skewY:0,perspective:0},validTransforms=["translateX","translateY","translateZ","rotateX","rotateY","rotateZ","scaleX","scaleY","scaleZ","skewX","skewY","perspective"];function toArray(item){return Array.isArray(item)?item:Array.from(item)}function flattenArray(item){if(Array.isArray(item)){let array=[];for(var i of item)array.concat(flattenArray(i));return array}return item}function decomposeValue(val,unit){var rgx=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,value=validateValue(val,unit)+"";return{numbers:value.match(rgx)?value.match(rgx).map(Number):[0],strings:"string"==typeof val||unit?value.split(rgx):[]}}function validateValue(val,unit){if(/\s/g.test(val))return val;var originalUnit="",unitLess=val;return unit?val+unit:val}function mergeStringAndNumber(values){var ans="";let i=0;for(;i<values.numbers.length;i++)ans+=values.strings[i],ans+=values.numbers[i];return ans+values.strings[i]}function random(end,start){return Math.random()*(end-start+1)+start}function easeInElastic(t,b,c,d){var s=1,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b}function easeOutQuad(t,b,c,d){return-c*(t/=d)*(t-2)+b}function easeInOutQuad(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b}function easeInSine(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b}function easeOutSine(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b}function easeInOutSine(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b}function easeInExpo(t,b,c,d){return 0==t?b:c*Math.pow(2,10*(t/d-1))+b}function easeOutExpo(t,b,c,d){return t==d?b+c:c*(1-Math.pow(2,-10*t/d))+b}function easeInOutExpo(t,b,c,d){return 0==t?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(2-Math.pow(2,-10*--t))+b}function easeInCirc(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b}function easeOutCirc(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b}function easeInOutCirc(t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b}function easeInCubic(t,b,c,d){return c*(t/=d)*t*t+b}function easeOutCubic(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b}function easeInOutCubic(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b}function easeInOutElastic(t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(2==(t/=d/2))return b+c;if(p||(p=d*(.3*1.5)),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}function easeOutElastic(t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b}function easeInQuad(t,b,c,d){return c*(t/=d)*t+b}function easeLinear(t,b,c,d){return c*t/d+b}function applyCSSChanges(i,j){validTransforms.includes(j.animation)?changeCSS(i.target,i.animations,"transform",j.postfix,!1):changeCSS(i.target,i.animations,j.animation,j.postfix,j.isAttribute)}function changeCSS(target,properties,animation,postfix,isAttribute){if(isAttribute)target.setAttribute(animation,mergeStringAndNumber(properties[animation]));else switch(animation){case"transform":target.style.transform=`translate3d(${properties.translateX}px, ${properties.translateY}px, ${properties.translateZ}px ) scaleX(${properties.scaleX}) scaleY(${properties.scaleY}) scaleZ(${properties.scaleZ}) rotateX(${properties.rotateX}deg) rotateY(${properties.rotateY}deg) rotateZ(${properties.rotateZ}deg) perspective(${properties.perspective}px) skew(${properties.skewX}deg, ${properties.skewY}deg) `;break;case"backgroundColor":target.style[animation]=`rgb(${properties[animation].red},${properties[animation].green},${properties[animation].blue})`;break;default:target.style[animation]=properties[animation]+postfix}}function getFromTransforms(obj,params,animations){for(var animation of animations)validTransforms.includes(animation)&&(obj[animation]=Array.isArray(params[animation])?params[animation][0]:obj[animation]);return obj}function getAllTransforms(transform,animations,params){var values=transform.split("(")[1].split(")")[0].split(","),a=values[0],b=values[1],angle=Math.round(Math.atan2(b,a)*(180/Math.PI));let obj=Object.assign({},defaultTransforms);if(obj.rotateZ=angle,!transform.includes("matrix3d")){let splited=transform.split("(")[1].split(", ");for(var i=0;i<6;i++)0!=i||animations.includes("scaleX")?1!=i||animations.includes("skewY")?2!=i||animations.includes("skewX")?3!=i||animations.includes("scaleY")?4!=i||animations.includes("translateX")?5!=i||animations.includes("translateY")||(obj.translateY=Number(splited[i].split(")")[0])):obj.translateX=Number(splited[i]):obj.scaleY=Number(splited[i]):obj.skewX=Number(splited[i]):obj.skewY=Number(splited[i]):obj.scaleX=Number(splited[i])}return obj=getFromTransforms(obj,params,animations),obj}function getInitialTransforms(styles,animations,params){var transform=styles.transform;if("none"!=transform)return getAllTransforms(transform,animations,params);{let obj=Object.assign({},defaultTransforms);return obj=getFromTransforms(obj,params,animations),obj}}function addInitialState(element,animations,params){var styles=getComputedStyle(element.target);element.animations=getInitialTransforms(styles,animations,params);for(let i of validAnimations)!validTransforms.includes(i)&&animations.includes(i)&&("opacity"==i?element.animations[i]=Array.isArray(params[i])?params[i][0]:styles[i]:"backgroundColor"===i?element.animations[i]=backgroundColorFromRGB(styles[i]):"d"===i&&element.target instanceof SVGElement?element.animations[i]=decomposeValue(element.target.getAttribute("d")):element.animations[i]=Array.isArray(params[i])?params[i][0]:Number(styles[i].split("px")[0]));return Object.assign({},element.animations)}function backgroundColorFromRGB(rgb){try{if("function"==typeof rgb)throw new Error("backgroundColor cannot be a function");if("string"==typeof rgb){let color=rgb.split("(")[1].split(",");return{red:Number(color[0]),green:Number(color[1]),blue:Number(color[2].split(")")[0])}}return rgb}catch(e){console.error(e)}}function getValues(value,parameter){return"string"==typeof value?"backgroundColor"===parameter?{value:backgroundColorFromRGB(value),isAttribute:!1}:{value:decomposeValue(value),isAttribute:!0}:Array.isArray(value)?{value:value[1],isAttribute:!1}:{value:value,isAttribute:!1}}function getAnimations(params){let animations=[];for(let i in params){let postfix="";if(degPostfix.includes(i)&&(postfix="deg"),pxPostfix.includes(i)&&(postfix="px"),validAnimations.includes(i)){let v=getValues(params[i],i),element={animation:i,value:"function"==typeof v.value?v.value():v.value,valuePassed:v.value,isAttribute:v.isAttribute,timeExpired:0,delayTimeExpired:0,postfix:postfix,isPlaying:!1,iteration:params.iteration};animations.push(element)}}return animations}function getAllTargets(target,delay,duration,animations,play,params){let targets=[];if(Array.isArray(target))for(var i=0;i<target.length;i++){let delayNow=Array.isArray(delay)?delay[i]:delay,durationNow=Array.isArray(duration)?duration[i]:duration,delayEndNow=Array.isArray(params.endDelay)?params.endDelay[i]:params.endDelay,playNow=Array.isArray(params.play)?params.play[i]:params.play;getTargetUtils(target[i],delayNow,durationNow,playNow,delayEndNow,params.whenVisible,params.iteration)}else getTargetUtils(target,delay,duration,params.play,params.endDelay,params.whenVisible,params.iteration);function getTargetUtils(target,delay,duration,play,delayEnd,whenVisible,iteration){let elements=document.querySelectorAll(target);elements=toArray(elements);let elementObject=[];for(let i=0;i<elements.length;i++){let element={target:elements[i],delay:delay+params.late*i,play:Array.isArray(play)?play[0]:play,duration:duration,direction:params.direction,loop:params.loop,endDelay:delayEnd,whenVisible:whenVisible,durationInSeconds:duration/1e3,animationInstances:getAnimations(params),timeExpired:0};element.animations=addInitialState(element,animations,params),element.InitialState=Object.assign({},element.animations),element.finalState=Array.from(element.animationInstances),elementObject.push(element)}targets=targets.concat(elementObject)}return targets}function addMoreParameters(valid){for(var i of acceptableParameters)null==valid[i]&&(valid[i]=initialParameters(i));return valid}function getValidParams(params){let valid={};for(var i of Object.keys(params))(acceptableParameters.includes(i)||validAnimations.includes(i))&&(valid[i]=params[i]);return valid=addMoreParameters(valid),valid}function getAnimationFunction(animation){return animationFunctions(animation)}function getAnimationsName(params){var animations=[];for(let i in params)validAnimations.includes(i)&&animations.push(i);return animations}function obtainTweens(params){let tweens={};var params=getValidParams(params);return tweens.targets=getAllTargets(params.targets,params.delay,params.duration,getAnimationsName(params),params.play,params),tweens.threshold=params.threshold,tweens.animationFunction=getAnimationFunction(params.animation),tweens}function getNewChangesInString(j,playItems,target){let number=[];for(let i=0;i<j.value.numbers.length;i++)target.animations[j.animation].numbers[i]===j.value.numbers[i]?number[i]=j.value.numbers[i]:number[i]=CallToAnimationFunction(playItems,.001*j.timeExpired,target.InitialState[j.animation].numbers[i],j.value.numbers[i]-target.InitialState[j.animation].numbers[i],target.durationInSeconds);return{numbers:number,strings:j.value.strings}}function findObjOfAnimation(j,InitialState){var value=j.value;return j.value="function"==typeof j.valuePassed?j.valuePassed():InitialState[j.animation],InitialState[j.animation]=value,{j:j,InitialState:InitialState}}function CallToAnimationFunction(playItems,t,b,c,d){return playItems.animationFunction()(t,b,c,d)}function getChangedColor(i,j){let changedColor={};for(var color of["red","green","blue"])changedColor[color]=Math.ceil(easeLinear(.001*j.timeExpired,i.InitialState.backgroundColor[color],j.value[color]-i.InitialState.backgroundColor[color],i.durationInSeconds));return changedColor}function Animation(i,j,playItems){let id=setInterval(()=>{let play="function"==typeof i.play?i.play():i.play;if(j.isPlaying=!0,play)if(j.delayTimeExpired<i.delay)j.delayTimeExpired+=10;else if(j.timeExpired+=10,j.timeExpired>=i.duration&&j.timeExpired<i.duration+i.endDelay);else{if(j.timeExpired>=i.duration){let k=!0===j.iteration||j.iteration--;if(!0===k||j.iteration>0){if("alternate"===i.direction){let obj=findObjOfAnimation(j,i.InitialState,i.finalState);i.InitialState=obj.InitialState,j=Object.assign({},obj.j)}else j.value="function"==typeof j.valuePassed?j.valuePassed():j.value;(!0===k||j.iteration)&&(j.timeExpired=0)}else j.isPlaying=!1,clearInterval(id)}var change;if("backgroundColor"===j.animation){let changedColor;change=getChangedColor(i,j)}else change=i.target instanceof SVGElement&&"d"==j.animation?getNewChangesInString(j,playItems,i):CallToAnimationFunction(playItems,.001*j.timeExpired,i.InitialState[j.animation],("function"==typeof j.value?j.value(j.timeExpired):j.value)-i.InitialState[j.animation],i.durationInSeconds);i.animations[j.animation]=change,applyCSSChanges(i,j)}},10)}function createInstectionObserver(i,j,playItems){let options={threshold:playItems.threshold},observer;new IntersectionObserver(entry=>{entry[0].isIntersecting&&!j.isPlaying&&Animation(i,j,playItems)},options).observe(i.target)}function playNow(playItems){for(let i of playItems.targets)for(let j of i.animationInstances)i.whenVisible?createInstectionObserver(i,j,playItems):Animation(i,j,playItems)}export function play(params){var playItems;playNow(obtainTweens(params))}play.random=random;